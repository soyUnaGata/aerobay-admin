import{r as P,o as z,w as W,d as ee,c as E,p as de,h as L,F as G,a as pe,i as te,b as C,e as N,f as h,g as we,j as $,k as he,l as re,m as j,n as ue,q as Pe,N as xe,s as Z,u as q,t as J,T as Se}from"./main-C_11dBjN.js";import{L as ke}from"./Loader-CKVVMDD7.js";import{F as se}from"./filter-service-BEVtHkuY.js";import{o,i as le,E as oe,u as V,t as Fe,a as U,q as Ee,N as _e,b as $e,w as Ce,c as Ie,h as Be,A as ae,d as R,n as ve,f as Q,e as X,P as O,g as I,l as Le,j as ie,k as T,m as B,T as Y}from"./portal-qxOlFC70.js";import"./api-2mOM-9YQ.js";function ce(r,s){if(r)return r;let i=s??"button";if(typeof i=="string"&&i.toLowerCase()==="button")return"button"}function Ne(r,s){let i=P(ce(r.value.type,r.value.as));return z(()=>{i.value=ce(r.value.type,r.value.as)}),W(()=>{var x;i.value||o(s)&&o(s)instanceof HTMLButtonElement&&!((x=o(s))!=null&&x.hasAttribute("type"))&&(i.value="button")}),i}var Te=(r=>(r[r.Open=0]="Open",r[r.Closed=1]="Closed",r))(Te||{});let fe=Symbol("PopoverContext");function ne(r){let s=te(fe,null);if(s===null){let i=new Error(`<${r} /> is missing a parent <${me.name} /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,ne),i}return s}let Oe=Symbol("PopoverGroupContext");function be(){return te(Oe,null)}let ge=Symbol("PopoverPanelContext");function De(){return te(ge,null)}let me=ee({name:"Popover",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(r,{slots:s,attrs:i,expose:x}){var S;let p=P(null);x({el:p,$el:p});let e=P(1),l=P(null),f=P(null),y=P(null),b=P(null),g=E(()=>le(p)),k=E(()=>{var t,n;if(!o(l)||!o(b))return!1;for(let K of document.querySelectorAll("body > *"))if(Number(K==null?void 0:K.contains(o(l)))^Number(K==null?void 0:K.contains(o(b))))return!0;let a=oe(),v=a.indexOf(o(l)),F=(v+a.length-1)%a.length,_=(v+1)%a.length,H=a[F],ye=a[_];return!((t=o(b))!=null&&t.contains(H))&&!((n=o(b))!=null&&n.contains(ye))}),m={popoverState:e,buttonId:P(null),panelId:P(null),panel:b,button:l,isPortalled:k,beforePanelSentinel:f,afterPanelSentinel:y,togglePopover(){e.value=V(e.value,{0:1,1:0})},closePopover(){e.value!==1&&(e.value=1)},close(t){m.closePopover();let n=t?t instanceof HTMLElement?t:t.value instanceof HTMLElement?o(t):o(m.button):o(m.button);n==null||n.focus()}};de(fe,m),Fe(E(()=>V(e.value,{0:U.Open,1:U.Closed})));let D={buttonId:m.buttonId,panelId:m.panelId,close(){m.closePopover()}},w=be(),A=w==null?void 0:w.registerPopover,[M,c]=Ee(),d=_e({mainTreeNodeRef:w==null?void 0:w.mainTreeNodeRef,portals:M,defaultContainers:[l,b]});function u(){var t,n,a,v;return(v=w==null?void 0:w.isFocusWithinPopoverGroup())!=null?v:((t=g.value)==null?void 0:t.activeElement)&&(((n=o(l))==null?void 0:n.contains(g.value.activeElement))||((a=o(b))==null?void 0:a.contains(g.value.activeElement)))}return W(()=>A==null?void 0:A(D)),$e((S=g.value)==null?void 0:S.defaultView,"focus",t=>{var n,a;t.target!==window&&t.target instanceof HTMLElement&&e.value===0&&(u()||l&&b&&(d.contains(t.target)||(n=o(m.beforePanelSentinel))!=null&&n.contains(t.target)||(a=o(m.afterPanelSentinel))!=null&&a.contains(t.target)||m.closePopover()))},!0),Ce(d.resolveContainers,(t,n)=>{var a;m.closePopover(),Ie(n,Be.Loose)||(t.preventDefault(),(a=o(l))==null||a.focus())},E(()=>e.value===0)),()=>{let t={open:e.value===0,close:m.close};return L(G,[L(c,{},()=>ae({theirProps:{...r,...i},ourProps:{ref:p},slot:t,slots:s,attrs:i,name:"Popover"})),L(d.MainTreeNode)])}}}),Ae=ee({name:"PopoverButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(r,{attrs:s,slots:i,expose:x}){var S;let p=(S=r.id)!=null?S:`headlessui-popover-button-${R()}`,e=ne("PopoverButton"),l=E(()=>le(e.button));x({el:e.button,$el:e.button}),z(()=>{e.buttonId.value=p}),pe(()=>{e.buttonId.value=null});let f=be(),y=f==null?void 0:f.closeOthers,b=De(),g=E(()=>b===null?!1:b.value===e.panelId.value),k=P(null),m=`headlessui-focus-sentinel-${R()}`;g.value||W(()=>{e.button.value=o(k)});let D=Ne(E(()=>({as:r.as,type:s.type})),k);function w(t){var n,a,v,F,_;if(g.value){if(e.popoverState.value===1)return;switch(t.key){case T.Space:case T.Enter:t.preventDefault(),(a=(n=t.target).click)==null||a.call(n),e.closePopover(),(v=o(e.button))==null||v.focus();break}}else switch(t.key){case T.Space:case T.Enter:t.preventDefault(),t.stopPropagation(),e.popoverState.value===1&&(y==null||y(e.buttonId.value)),e.togglePopover();break;case T.Escape:if(e.popoverState.value!==0)return y==null?void 0:y(e.buttonId.value);if(!o(e.button)||(F=l.value)!=null&&F.activeElement&&!((_=o(e.button))!=null&&_.contains(l.value.activeElement)))return;t.preventDefault(),t.stopPropagation(),e.closePopover();break}}function A(t){g.value||t.key===T.Space&&t.preventDefault()}function M(t){var n,a;r.disabled||(g.value?(e.closePopover(),(n=o(e.button))==null||n.focus()):(t.preventDefault(),t.stopPropagation(),e.popoverState.value===1&&(y==null||y(e.buttonId.value)),e.togglePopover(),(a=o(e.button))==null||a.focus()))}function c(t){t.preventDefault(),t.stopPropagation()}let d=ve();function u(){let t=o(e.panel);if(!t)return;function n(){V(d.value,{[B.Forwards]:()=>O(t,I.First),[B.Backwards]:()=>O(t,I.Last)})===Y.Error&&O(oe().filter(a=>a.dataset.headlessuiFocusGuard!=="true"),V(d.value,{[B.Forwards]:I.Next,[B.Backwards]:I.Previous}),{relativeTo:o(e.button)})}n()}return()=>{let t=e.popoverState.value===0,n={open:t},{...a}=r,v=g.value?{ref:k,type:D.value,onKeydown:w,onClick:M}:{ref:k,id:p,type:D.value,"aria-expanded":e.popoverState.value===0,"aria-controls":o(e.panel)?e.panelId.value:void 0,disabled:r.disabled?!0:void 0,onKeydown:w,onKeyup:A,onClick:M,onMousedown:c};return L(G,[ae({ourProps:v,theirProps:{...s,...a},slot:n,attrs:s,slots:i,name:"PopoverButton"}),t&&!g.value&&e.isPortalled.value&&L(Q,{id:m,features:X.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:u})])}}}),Me=ee({name:"PopoverPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},focus:{type:Boolean,default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(r,{attrs:s,slots:i,expose:x}){var S;let p=(S=r.id)!=null?S:`headlessui-popover-panel-${R()}`,{focus:e}=r,l=ne("PopoverPanel"),f=E(()=>le(l.panel)),y=`headlessui-focus-sentinel-before-${R()}`,b=`headlessui-focus-sentinel-after-${R()}`;x({el:l.panel,$el:l.panel}),z(()=>{l.panelId.value=p}),pe(()=>{l.panelId.value=null}),de(ge,l.panelId),W(()=>{var c,d;if(!e||l.popoverState.value!==0||!l.panel)return;let u=(c=f.value)==null?void 0:c.activeElement;(d=o(l.panel))!=null&&d.contains(u)||O(o(l.panel),I.First)});let g=Le(),k=E(()=>g!==null?(g.value&U.Open)===U.Open:l.popoverState.value===0);function m(c){var d,u;switch(c.key){case T.Escape:if(l.popoverState.value!==0||!o(l.panel)||f.value&&!((d=o(l.panel))!=null&&d.contains(f.value.activeElement)))return;c.preventDefault(),c.stopPropagation(),l.closePopover(),(u=o(l.button))==null||u.focus();break}}function D(c){var d,u,t,n,a;let v=c.relatedTarget;v&&o(l.panel)&&((d=o(l.panel))!=null&&d.contains(v)||(l.closePopover(),((t=(u=o(l.beforePanelSentinel))==null?void 0:u.contains)!=null&&t.call(u,v)||(a=(n=o(l.afterPanelSentinel))==null?void 0:n.contains)!=null&&a.call(n,v))&&v.focus({preventScroll:!0})))}let w=ve();function A(){let c=o(l.panel);if(!c)return;function d(){V(w.value,{[B.Forwards]:()=>{var u;O(c,I.First)===Y.Error&&((u=o(l.afterPanelSentinel))==null||u.focus())},[B.Backwards]:()=>{var u;(u=o(l.button))==null||u.focus({preventScroll:!0})}})}d()}function M(){let c=o(l.panel);if(!c)return;function d(){V(w.value,{[B.Forwards]:()=>{let u=o(l.button),t=o(l.panel);if(!u)return;let n=oe(),a=n.indexOf(u),v=n.slice(0,a+1),F=[...n.slice(a+1),...v];for(let _ of F.slice())if(_.dataset.headlessuiFocusGuard==="true"||t!=null&&t.contains(_)){let H=F.indexOf(_);H!==-1&&F.splice(H,1)}O(F,I.First,{sorted:!1})},[B.Backwards]:()=>{var u;O(c,I.Previous)===Y.Error&&((u=o(l.button))==null||u.focus())}})}d()}return()=>{let c={open:l.popoverState.value===0,close:l.close},{focus:d,...u}=r,t={ref:l.panel,id:p,onKeydown:m,onFocusout:e&&l.popoverState.value===0?D:void 0,tabIndex:-1};return ae({ourProps:t,theirProps:{...s,...u},attrs:s,slot:c,slots:{...i,default:(...n)=>{var a;return[L(G,[k.value&&l.isPortalled.value&&L(Q,{id:y,ref:l.beforePanelSentinel,features:X.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:A}),(a=i.default)==null?void 0:a.call(i,...n),k.value&&l.isPortalled.value&&L(Q,{id:b,ref:l.afterPanelSentinel,features:X.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:M})])]}},features:ie.RenderStrategy|ie.Static,visible:k.value,name:"PopoverPanel"})}}});function je(r,s){return C(),N("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[h("path",{"fill-rule":"evenodd",d:"M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})])}const Ge={class:"fixed left-0 top-0 h-screen w-64 bg-gray-800 text-white"},Ve={class:"w-screen"},Re={key:0,class:"ml-64 flex-1 p-4 w-full"},He=["id"],Ke=["onClick"],qe={class:"w-screen max-w-md flex-auto overflow-hidden rounded-3xl bg-white text-sm leading-6 ring-gray-900/5"},Ue={class:"p-4"},ze={class:"font-semibold text-gray-900"},Ye={__name:"AboutView",setup(r){const s=P(),i=P(!0),x=async()=>{try{s.value=await se.getAllFilters()}catch(p){console.error("Ошибка при загрузке подкатегорий:",p)}finally{i.value=!1}},S=async(p,e)=>{try{await se.removeFilter(p),s.value.splice(e,1),console.log("Фильтр успешно удален")}catch(l){console.error("Ошибка при удалении фильтра:",l)}};return we(s,(p,e)=>{console.log("Массив filters изменился:"),console.log("Старое значение:",e),console.log("Новое значение:",p)},{deep:!0}),z(async()=>{await x()}),(p,e)=>{const l=Pe("RouterLink");return C(),N(G,null,[h("nav",Ge,[$(xe)]),h("div",Ve,[i.value?(C(),he(ke,{key:0})):re("",!0)]),i.value?re("",!0):(C(),N("div",Re,[e[3]||(e[3]=h("h2",{class:""},"Filters",-1)),$(l,{to:{name:"filter-add"},class:"rounded-md bg-indigo-600 px-3.5 py-2.5 text-sm font-semibold text-white shadow-xs hover:bg-indigo-500 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},{default:j(()=>e[0]||(e[0]=[Z(" Add ")])),_:1}),(C(!0),N(G,null,ue(s.value,(f,y)=>(C(),N("div",{class:"flex",name:"fade",key:f.id,id:f.id},[$(q(me),{id:f.id,class:"relative shadow-lg ring-1 ring-gray-900/5 w-100 w-screen flex-auto overflow-hidden rounded-3xl bg-white text-sm leading-6"},{default:j(()=>[$(q(Ae),{class:"dropdown__filter inline-flex h-12 items-center gap-x-1 text-sm font-semibold leading-6 text-gray-900 pl-3"},{default:j(()=>[h("span",null,J(f.name),1),h("span",null,J(p.group),1),$(q(je),{class:"h-5 w-5","aria-hidden":"true"})]),_:2},1024),$(l,{to:{name:"filter-edit",params:{id:f.id}}},{default:j(()=>e[1]||(e[1]=[Z("Edit")])),_:2},1032,["to"]),h("button",{class:"text-red-700",onClick:b=>S(f.id,y)},"Delete",8,Ke),$(Se,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-1"},{default:j(()=>[$(q(Me),{class:"left-1/2 z-10 mt-5 flex w-screen max-w-max px-4"},{default:j(()=>[h("div",qe,[h("div",Ue,[(C(!0),N(G,null,ue(f.filter_values,(b,g)=>(C(),N("div",{key:g,class:"group relative flex gap-x-6 rounded-lg p-4 hover:bg-gray-50"},[h("div",null,[h("a",ze,[Z(J(b.value)+" ",1),e[2]||(e[2]=h("span",{class:"absolute inset-0"},null,-1))])])]))),128))])])]),_:2},1024)]),_:2},1024)]),_:2},1032,["id"])],8,He))),128))]))],64)}}};export{Ye as default};
