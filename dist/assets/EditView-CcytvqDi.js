import{r as i,g as j,o as L,e as s,j as v,m as R,f as r,v as V,x as d,y as F,F as f,n as p,l as y,z as N,u as G,A as $,B as C,q,b as o,s as z,N as A,t as S}from"./main-Cjdx7q60.js";import{F as b}from"./filter-value-service-DxA5ilxP.js";import{F as B}from"./filter-service-BUlG1M6d.js";import{_ as I}from"./SuccessNotification-CWTHgcNT.js";import{s as H}from"./showNotification-BCRs6ctT.js";import"./api-DS0brFyY.js";const J={class:"fixed left-0 top-0 h-screen w-64 bg-gray-800 text-white"},K={class:"ml-64 flex-1 p-4 w-full"},O={class:"flex items-baseline gap-12"},P={class:""},Q={class:"mt-4"},W=["onUpdate:modelValue"],X=["onClick"],Y={class:""},Z=["value"],ee={key:1,class:"text-sm text-red-600 mt-2"},te=["value"],le={key:3,class:"text-sm text-red-600 mt-2"},de={__name:"EditView",setup(re){const x=$(),n=i(x.params.id),l=i({filter:{name:"",category_id:null,group_id:null,filter_values:[]}});let w=i(!1);const c=i([]),u=i([]),g=i([]),h=async()=>{try{l.value=await B.getFilter(n.value),(!l.value.filter.filter_values||l.value.filter.filter_values.length===0)&&(l.value.filter.filter_values=[{value:""}])}catch(t){console.error("Ошибка при загрузке группы:",t)}},U=async()=>{try{const t=await C.get("https://aerobay.onrender.com/api/categories");u.value=t.data,console.log(u.value)}catch(t){console.error("Ошибка при загрузке категорий:",t)}},D=async()=>{try{const t=await C.get("https://aerobay.onrender.com/api/groups");g.value=t.data}catch(t){console.error("Ошибка при загрузке групп:",t)}},E=()=>{l.value.filter.filter_values.push({value:""})},M=(t,e)=>{l.value.filter.filter_values.splice(t,1),e&&c.value.push(e)},_=async()=>{try{await B.updateFilter(n.value,l.value.filter.name,l.value.filter.category_id,l.value.filter.group_id);for(const t of l.value.filter.filter_values)t.value.trim()!==""&&(t.id?await b.updateFilter(t.id,t.value,n.value):await b.postFilter(t.value,n.value));for(let t of c.value)await b.removeFilter(t);c.value=[],await H(w)}catch(t){console.error("Ошибка при обновлении данных:",t)}window.location.href="/filters"};return j(()=>x.params.id,async t=>{t&&(n.value=t,await h())}),L(async()=>{await h(),await U(),await D()}),(t,e)=>{const T=q("RouterLink");return o(),s(f,null,[v(T,{to:"/about"},{default:R(()=>e[3]||(e[3]=[z("Back")])),_:1}),r("nav",J,[v(A)]),r("div",K,[r("div",O,[r("div",P,[l.value&&l.value.filter?(o(),s("form",{key:0,onSubmit:V(_,["prevent"])},[e[7]||(e[7]=r("label",{for:"filterName",class:"block text-sm font-medium leading-6 text-gray-900 mb-2"}," Filter name ",-1)),d(r("input",{type:"text",id:"filterName",class:"block rounded-md border-0 py-1.5 pl-7 pr-20 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6","onUpdate:modelValue":e[0]||(e[0]=a=>l.value.filter.name=a),placeholder:"Enter filter name"},null,512),[[F,l.value.filter.name]]),r("div",Q,[e[6]||(e[6]=r("label",{for:"filterValues",class:"block text-sm font-medium leading-6 text-gray-900 mb-2"}," Filter values ",-1)),(o(!0),s(f,null,p(l.value.filter.filter_values,(a,m)=>(o(),s("div",{key:m,class:"relative flex gap-2.5 mt-2"},[d(r("input",{type:"text","onUpdate:modelValue":k=>a.value=k,class:"block rounded-md border-0 py-1.5 pl-7 pr-20 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",placeholder:"Enter value"},null,8,W),[[F,a.value]]),m===l.value.filter.filter_values.length-1?(o(),s("button",{key:0,onClick:E,class:"inset-y-0 justify-center right-0 flex items-center px-3 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-bold rounded-full w-8 h-8 shadow-lg transition transform hover:scale-110 active:scale-95"},e[4]||(e[4]=[r("span",{class:"text-lg"},"+",-1)]))):y("",!0),r("button",{type:"button",onClick:k=>M(m,a.id),class:"flex items-center justify-center w-8 h-8 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white rounded-full shadow-lg transition transform hover:scale-110 active:scale-95"},e[5]||(e[5]=[r("span",{class:"text-lg"},"−",-1)]),8,X)]))),128))]),e[8]||(e[8]=r("button",{type:"submit",class:"mt-4 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded"}," Save ",-1))],32)):y("",!0)]),r("div",Y,[l.value&&l.value.filter?(o(),s("form",{key:0,onSubmit:V(_,["prevent"])},[e[11]||(e[11]=r("label",{for:"category",class:"block text-sm font-medium leading-6 text-gray-900 mt-4 mb-2"}," Category ",-1)),u.value.data?d((o(),s("select",{key:0,id:"category","onUpdate:modelValue":e[1]||(e[1]=a=>l.value.filter.category_id=a),class:"block w-full border-0 rounded-md border-gray-300 text-gray-900 ring-1 shadow-sm ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm py-1.5 pl-7 pr-20"},[e[9]||(e[9]=r("option",{value:"",disabled:"",selected:""},"Select category",-1)),(o(!0),s(f,null,p(u.value.data,a=>(o(),s("option",{key:a.id,value:a.id},S(a.name),9,Z))),128))],512)),[[N,l.value.filter.category_id]]):(o(),s("div",ee," There is no categories yet. ")),e[12]||(e[12]=r("label",{for:"group",class:"block text-sm font-medium leading-6 text-gray-900 mt-4 mb-2"}," Group ",-1)),g.value.data?d((o(),s("select",{key:2,id:"group","onUpdate:modelValue":e[2]||(e[2]=a=>l.value.filter.group_id=a),class:"block w-full border-0 rounded-md border-gray-300 text-gray-900 ring-1 shadow-sm ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm py-1.5 pl-7 pr-20"},[e[10]||(e[10]=r("option",{value:"",disabled:"",selected:""},"Choose group",-1)),(o(!0),s(f,null,p(g.value.data,a=>(o(),s("option",{key:a.id,value:a.id},S(a.name),9,te))),128))],512)),[[N,l.value.filter.group_id]]):(o(),s("div",le," There is no groups yet. "))],32)):y("",!0)])])]),v(I,{isVisible:G(w)},null,8,["isVisible"])],64)}}};export{de as default};
