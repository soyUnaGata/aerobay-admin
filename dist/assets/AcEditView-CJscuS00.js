import{r,E as K,w as Q,o as X,e as f,f as t,j as o,k as Y,l as k,t as I,u as i,m as S,x as V,y as q,F as Z,A as ee,q as te,b as m,N as ae,s as se}from"./main-C_11dBjN.js";/* empty css                            */import{c as le,a as E,b as p,u as oe,f as ie,M as re,I as ne,F as v,E as b,e as ue}from"./index.esm-D0dABgF5.js";import{C as ce}from"./CategorySelect-hGntECxL.js";import{L as de}from"./Loader-CKVVMDD7.js";import{F as me}from"./filter-value-service-DkuJmKTs.js";import{M as pe}from"./manufactures-service-BeyKSNb9.js";import{A as F}from"./accessory-service-ij6YPMRx.js";import{I as ve}from"./image-service-CFerL2Ux.js";import{_ as ge}from"./SuccessNotification-JvhaBRCE.js";import{s as ye}from"./showNotification-BCRs6ctT.js";import{C as fe}from"./category-service-Dq39Gxa9.js";import"./api-2mOM-9YQ.js";const be={class:"fixed left-0 top-0 h-screen w-64 bg-gray-800 text-white"},xe={key:1,class:"ml-64 flex-1 p-4 w-full"},we={class:"text-xl font-semibold"},_e={class:"flex flex-col gap-2.5"},ke={class:"space-y-2"},he={key:0,class:"text-red-500 text-sm"},Ie={class:"space-y-2 col-span-2"},Ve={key:0,class:"text-red-500 text-sm"},qe={class:"space-y-2"},Me={class:"space-y-2"},Ce={class:"space-y-2"},Ae={class:"margin-top flex flex-col gap-2.5"},Se={class:"space-y-2"},Ee={class:"space-y-2"},Fe={class:"space-y-2"},De={class:"space-y-2"},Te={class:"space-y-2"},Ue={class:"space-y-2"},Ne={class:"space-y-2"},Be={class:"space-y-2"},Ye={__name:"AcEditView",setup(Le){const D=ee(),M=r(D.params.id),a=r({}),g=r([]),T=r([]),x=r(),h=r([]),c=r([]),w=r(!0);let C=r(!1);const _=r([]),U=r();r(null);const N=le({title:E().required("Title is required"),description:E().required("Description is required"),price:p().typeError("Price must be a number").required("Price is required"),discount:p().typeError("Discount must be a number").required("Discount is required"),weight:p().typeError("Weight must be a number").required("Weight is required").notOneOf([0],"Weight cannot be 0"),amount:p().typeError("Amount must be a number").required("Amount is required"),manufacturer_id:p().nullable().required("Manufacturer is required"),category_id:p().nullable().required("Category is required")}),{handleSubmit:B,setFieldValue:u}=oe({validationSchema:N,initialValues:{description:""},validateOnMount:!1}),L=async()=>{try{a.value=await F.getAccessory(M.value),c.value=a.value.images.map(s=>s.id)||[],a.value.description=a.value.description||"",y.value=a.value.filter_values||[]}catch(s){console.error(s)}finally{w.value=!1}},O=async()=>{try{g.value=await me.getAllValues()}catch(s){console.error(s)}},W=async()=>{try{T.value=await pe.getAllManufactures()}catch(s){console.log(s)}},P=async()=>{try{U.value=await fe.getAllCategories()}catch(s){console.log(s)}},R=s=>{a.value.manufacturer_id=s},$=s=>{a.value.category_id=s},j=s=>{c.value=s,console.log("Выбранные изображения:",c.value)},H=s=>{const e=document.createElement("div");return e.innerHTML=s,e.textContent||e.innerText||""},A=B(async s=>{var e,n;try{_.value={};const l={...s,description:H(s.description),images:c.value||[],filter_values:y.value.map(d=>d.id)||[],subcategories:K(a.value.subcategories.map(d=>d.id))};await F.updateAccessory(M.value,l),w.value=!0,await ye(C),window.location.href="/accessories"}catch(l){_.value=((n=(e=l.response)==null?void 0:e.data)==null?void 0:n.errors)||{}}}),z=async()=>{try{h.value=await ve.getAllImages(),console.log(h.value)}catch(s){console.log(s)}};Q(()=>{var s;if(((s=a.value.filter_values)==null?void 0:s.length)>0){const e=new Set(a.value.filter_values.map(n=>n.value));x.value=[...a.value.filter_values],console.log(x.value),g.value.forEach(n=>{e.has(n.value)||x.value.push(n)})}else x.value=g.value.map(e=>{var n;return[e.value,(n=e.filter)==null?void 0:n.name]}),console.log(g.value)});const y=r([]),G={height:400,menubar:!1,plugins:["link","image","table","lists"],toolbar:"undo redo | formatselect | bold italic | alignleft aligncenter alignright | bullist numlist outdent indent | removeformat"};return X(async()=>{await L(),await O(),await W(),await P(),await z(),u("title",a.value.title),u("price",a.value.price),u("discount",a.value.discount),u("description",a.value.description||""),u("weight",a.value.weight),u("amount",a.value.amount),u("manufacturer_id",a.value.manufacturer_id),u("category_id",a.value.category_id),c.value=a.value.images.map(s=>s.id)||[],y.value=a.value.filter_values||[]}),(s,e)=>{const n=te("RouterLink");return m(),f(Z,null,[t("nav",be,[o(ae)]),w.value?(m(),Y(de,{key:0})):k("",!0),w.value?k("",!0):(m(),f("div",xe,[t("h2",we,I(a.value.title),1),(m(),f("div",{class:"grid grid-cols-1 md:grid-cols-2 gap-4 border p-4 rounded-lg shadow-md",key:a.value.id},[t("div",_e,[t("div",ke,[e[7]||(e[7]=t("label",{class:"block text-gray-700"},"Title",-1)),o(i(v),{name:"title",class:"input-field w-full",type:"text",placeholder:"Title"}),o(i(b),{name:"title",class:"text-red-500 text-sm"}),_.value.title?(m(),f("span",he,I(_.value.title[0]),1)):k("",!0)]),t("div",Ie,[e[8]||(e[8]=t("label",{class:"block text-gray-700"},"Description",-1)),o(i(v),{name:"description"},{default:S(({value:l,errorMessage:d,handleChange:J})=>[o(i(ue),{"api-key":"odcydkl28d7x03wgsip6dxzkqtcx5olxt496s6x1nu87870j",init:G,modelValue:l,"onUpdate:modelValue":J},null,8,["modelValue","onUpdate:modelValue"]),d?(m(),f("span",Ve,I(d),1)):k("",!0)]),_:1})]),t("div",qe,[e[9]||(e[9]=t("label",{class:"block text-gray-700"},"Price",-1)),o(i(v),{name:"price",class:"input-field w-full",type:"number",placeholder:"Price"}),o(i(b),{name:"price",class:"text-red-500 text-sm"})]),t("div",Me,[e[10]||(e[10]=t("label",{class:"block text-gray-700"},"Discount (%)",-1)),o(i(v),{name:"discount",class:"input-field w-full",type:"number",placeholder:"Discount"}),o(i(b),{name:"discount",class:"text-red-500 text-sm"})]),t("div",Ce,[e[11]||(e[11]=t("label",{class:"block text-gray-700"},"Image url",-1)),V(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.image_url=l),class:"input-field w-full",type:"text",placeholder:"Image url"},null,512),[[q,a.value.image_url]])])]),t("div",Ae,[t("div",Se,[e[12]||(e[12]=t("label",{class:"block text-gray-700"},"Dimensions",-1)),V(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.dimensions=l),class:"input-field w-full",type:"text",placeholder:"Dimensions"},null,512),[[q,a.value.dimensions]])]),t("div",Ee,[e[13]||(e[13]=t("label",{class:"block text-gray-700"},"Weight",-1)),o(i(v),{name:"weight",class:"input-field w-full",type:"text",placeholder:"Weight"}),o(i(b),{name:"weight",class:"text-red-500 text-sm"})]),t("div",Fe,[e[14]||(e[14]=t("label",{class:"block text-gray-700"},"Type",-1)),V(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.type=l),class:"input-field w-full",type:"text",placeholder:"Type"},null,512),[[q,a.value.type]])]),t("div",De,[e[15]||(e[15]=t("label",{class:"block text-gray-700"},"Amount left",-1)),o(i(v),{name:"amount",class:"input-field w-full",type:"number",placeholder:"Amount"}),o(i(b),{name:"amount",class:"text-red-500 text-sm"})]),t("div",Te,[e[16]||(e[16]=t("label",{class:"block text-gray-700"},"Manufacturer",-1)),o(ie,{selectedManufacturerId:a.value.manufacturer_id,"onUpdate:selectedManufacturerId":e[3]||(e[3]=l=>{R(l),i(u)("manufacturer_id",l)})},null,8,["selectedManufacturerId"])]),t("div",Ue,[e[17]||(e[17]=t("label",{class:"block text-gray-700"},"Category",-1)),o(ce,{selectedCategoryId:a.value.category_id,"onUpdate:selectedCategoryId":e[4]||(e[4]=l=>{$(l),i(u)("category_id",l)})},null,8,["selectedCategoryId"])]),t("div",Ne,[e[18]||(e[18]=t("label",{class:"block text-gray-700"},"Filter",-1)),o(re,{options:g.value,modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=l=>y.value=l)},null,8,["options","modelValue"])]),t("div",Be,[e[19]||(e[19]=t("label",{class:"block text-gray-700"},"Images",-1)),t("div",null,[o(ne,{images:h.value,initialImageIds:c.value,"onUpdate:imageIds":j},null,8,["images","initialImageIds"])])])]),t("button",{onClick:e[6]||(e[6]=(...l)=>i(A)&&i(A)(...l)),class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"},"Save "),o(n,{to:"/accessories"},{default:S(()=>e[20]||(e[20]=[se("Back")])),_:1})]))])),o(ge,{isVisible:i(C)},null,8,["isVisible"])],64)}}};export{Ye as default};
